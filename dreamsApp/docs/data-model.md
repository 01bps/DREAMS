# Data Models â€“ DREAMS Platform

This document outlines the data schema used across the four MongoDB collections in the DREAMS platform.

---

## 1. Collection: `users`

Stores admin credentials for platform access.

| Field           | Type     | Description                      |
|-----------------|----------|----------------------------------|
| `_id`           | ObjectId | Unique MongoDB document ID       |
| `username`      | string   | Admin username                   |
| `email`         | string   | Admin email                      |
| `password_hash` | string   | Secure password hash             |

> *Used with `Flask-Login` and `werkzeug.security` for admin-only authentication.*

---

## 2. Collection: `posts`

Stores each uploaded image and associated metadata.

| Field               | Type       | Description                            |
|---------------------|------------|----------------------------------------|
| `_id`               | ObjectId   | Document ID                            |
| `user_id`           | string     | Pseudonymous or anonymous user ID      |
| `caption`           | string     | User-written caption                   |
| `timestamp`         | datetime   | Time of submission                     |
| `image_path`        | string     | Path to stored image                   |
| `generated_caption` | string     | Caption generated by BLIP              |
| `sentiment`         | object     | Output of caption sentiment classifier |

**Sentiment Example:**
```json
{
    "sentiment": {
        "label": "positive",
        "score": 0.91
    }
}
```

---

## 3. Collection: `keywords`

Stores user-specific keyword clusters with sentiment polarity.

| Field               | Type           | Description                                 |
|---------------------|----------------|---------------------------------------------|
| `_id`               | ObjectId       | Document ID                                 |
| `user_id`           | string         | Associated user                             |
| `positive_keywords` | array<object>  | List of clustered keywords (positive)       |
| `negative_keywords` | array<object>  | List of clustered keywords (negative)       |

---

## 4. Collection: `thematic_analysis` 

Stores high-level narrative insights inferred by LLMs, separated by sentiment.

| Field   | Type     | Description                       |
|---------|----------|-----------------------------------|
| `_id`   | ObjectId | Document ID                       |
| `user_id` | string | Related user ID                   |
| `data`  | object   | Contains positive and negative themes |

**Thematic Analysis Example:**
```json
{
    "data": {
        "positive": [
            {
                "theme": "Hope",
                "meaning": "The user felt hopeful about recovery."
            }
        ],
        "negative": [
            {
                "theme": "Fear",
                "meaning": "The user felt scared or anxious."
            }
        ]
    }
}
```
Each theme entry includes:
- **theme**: A concise label (e.g., "Hope", "Fear")
- **meaning**: Human-readable explanation generated by an LLM (e.g., Gemini)

---

##  Access Control

- Only the `users` collection is authenticated via Flask-Login.
- All other collections are accessed programmatically by the backend and admin panel.

---

##  Future Enhancements

- Add `location` field to `posts` for geospatial correlation.
- Store `emotion_vector` for multi-label emotional analysis.
- Add `transcript` for ASR-generated voice note captions.
- Include `duplicate_location_id` for proximity tracking.

---

This modular MongoDB schema supports time-aware, cluster-based, and emotion-driven storytelling for visual and narrative recovery journeys.
